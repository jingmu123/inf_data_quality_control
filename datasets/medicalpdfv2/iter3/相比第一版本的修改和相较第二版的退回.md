相比第一版本修改了

- 图片描述相关，补充出现的图片描述新情况这里没问题

  ```
  这个规则不够灵活
  if item.strip() in ["##References","## References","## Suggested Readings","##Suggested Readings"]:
  ↓
  if re.search(r'^#{1,3}\s?(Reference|Suggested Reading)s?',item.strip()):
  ```

- 如果句子中出现©，一般是与版权相关的句子，在is_fig函数中加入了©特征

```
def is_fig(self,block_text):
    if re.search('^[\s•]{0,3}([Ff]igs?(ure)?s?|F\s?IGS?(URE)?s?|Ref|DOI)',block_text):
        return True
    if re.search("↓|©",block_text) and not re.search(r'\|',block_text):
        return True
    return False
```

**为解决误删修改了（这里出了问题，在第二版本加入了and re.search(r'参考删除',text)的条件，第三版删除）**

```
label = fasttext_model.predict(text.strip().replace('\n', ''))
print(label[0][0])
if label[0][0] in ['__label__cankao']  and not re.search(r'参考删除-4',text) and re.search(r'参考删除',text):
    context.insert(0, "(本页删除)本页被模型判断为参考页")
if label[0][0] in ['__label__mulu']:
    context.insert(0, "(本页删除)本页被模型判断为目录页")
```

对正则删除1前面加了一个删除20，这个没问题

```
将带括号的一些网址先删掉，这样删除1就匹配不到这条，解决一些误删
[
    r'(\([^\(\)]*(([Ww]{2,3}\.)|(\.[Cc][Oo][Mm])|(http)|(\.html))[^\)\(]*\))',
    r'删除20:<u>\1</u>'
],
[
    r'([^\d][^\.\n]*(([Ww]{2,3}\.)|(\.[Cc][Oo][Mm])|(http)|(\.html))[^\n]*)',
    r'删除1:<u>\1</u>'
],
```

**换行这里加入两条新规则出了问题，第三版已删**

```
if re.search(r'^\d+\s?[^\.]',next_text) and self.is_merge_ngram(text, next_text):    # 如果遇到 20 mm 这种情况的多余换行
            return True
            
            
if re.search(r'^\(',next_text.strip()) and text.strip()[-1].islower() and not re.search(r'#',text):    # 如果出现下一行是左括号开头，且上一行不是标点结尾
            return True


```

